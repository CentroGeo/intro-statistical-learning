---
title: "Linear regression"
output:
  html_document:
    df_print: paged
---
Read the csv file and get the Advertising dataset 

```{r}
(ads <- read.csv("/home/eureka/Documentos/notebooks/advertising/Advertising.csv"))
```

Now we are going to fit a linear regression model using [lm.fit (Fitter for Linear Models)](https://www.rdocumentation.org/packages/pbdDMAT/versions/0.4-2/topics/lm.fit), returns a list of values similar to R's lm.fit(). Namely, the list contains: Residuals (difference in the numerical fit and the observed ) and Coefficients
(solution to the linear least squares problem).


```{r}
lm.fit = lm(sales ~ TV, data=ads)
summary(lm.fit)
```


```{r}
plot(ads$TV, ads$sales,col='blue',pch=20,xlab = "TV", ylab = "sales") # QuÃ© es un ads pabs??
abline(lm.fit) #abline draws a line with the lm.fit values  
```


```{r}
plot(lm.fit)
```

## Residuals for Advertising Sales

#### Now lets look at the regression of the sales as a function of the TV, Radio, and Newspaper advertising.
#### TV

```{r}
plot(ads$TV, ads$sales,col='red',pch=20,xlab = "TV", ylab = "sales")
lm.fit <- lm(sales ~ TV, data=ads)
abline(lm.fit)
```


```{r}
sprintf('R-squared: %f', summary(lm.fit)$r.squared)
```

```{r}
sprintf('Correlation^2: %f', cor(ads$sales,ads$TV)^2)
```

#### Newspaper

```{r}
plot(ads$newspaper, ads$sales,col='red',pch=20,xlab = "newspaper", ylab = "sales")
lm.fit <- lm(sales ~ newspaper, data=ads)
abline(lm.fit)
```

```{r}
sprintf('R-squared: %f', summary(lm.fit)$r.squared)
```

```{r}
sprintf('Correlation^2: %f', cor(ads$sales,ads$newspaper)^2)
```

http://marek.petrik.us/teaching/intro_ml_17_files/linear_regression.html